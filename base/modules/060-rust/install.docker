USER dev
RUN curl https://sh.rustup.rs -sSf | sh -s -- -y --default-toolchain nightly \
    && echo 'export path=($HOME/.cargo/bin $path)' >> ~/.zshenv \
    && export path=($HOME/.cargo/bin $path) \
    && rustup component add rls rust-analysis rust-src rustfmt clippy \
    && sudo apt-get update \
    && sudo apt-get install -y --no-install-recommends pkg-config libssl-dev \
    && cargo install cargo-tree cargo-modules cargo-outdated cargo-cache cargo-make cargo-script cargo-generate

USER root